<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculator</title>
    <link rel="stylesheet" href="calculator.css">
</head>
<body>
    <div class="calculator" role="application" aria-label="Calculator">
        <div class="display">
            <div class="display-previous" id="previousOperand" role="status" aria-live="polite" aria-atomic="true" aria-label="Previous calculation"></div>
            <div class="display-current" id="currentOperand" role="status" aria-live="polite" aria-atomic="true" aria-label="Current value">0</div>
        </div>
        <div class="buttons">
            <button class="btn-clear" data-action="clear" aria-label="Clear all">AC</button>
            <button class="btn-delete" data-action="delete" aria-label="Delete last digit">DEL</button>
            <button class="btn-operator" data-operator="÷" aria-label="Divide">÷</button>
            
            <button data-number="7" aria-label="Number 7">7</button>
            <button data-number="8" aria-label="Number 8">8</button>
            <button data-number="9" aria-label="Number 9">9</button>
            <button class="btn-operator" data-operator="×" aria-label="Multiply">×</button>
            
            <button data-number="4" aria-label="Number 4">4</button>
            <button data-number="5" aria-label="Number 5">5</button>
            <button data-number="6" aria-label="Number 6">6</button>
            <button class="btn-operator" data-operator="-" aria-label="Subtract">-</button>
            
            <button data-number="1" aria-label="Number 1">1</button>
            <button data-number="2" aria-label="Number 2">2</button>
            <button data-number="3" aria-label="Number 3">3</button>
            <button class="btn-operator" data-operator="+" aria-label="Add">+</button>
            
            <button class="btn-zero" data-number="0" aria-label="Number 0">0</button>
            <button data-number="." aria-label="Decimal point">.</button>
            <button class="btn-equals" data-action="equals" aria-label="Calculate result">=</button>
        </div>
    </div>

    <script>
        // ============================================================================
        // KEYBOARD EVENT LISTENER INFRASTRUCTURE
        // ============================================================================
        
        /**
         * Centralized key mapping system
         * Maps keyboard keys to calculator button selectors
         * Note: * maps to × (multiplication symbol) and / maps to ÷ (division symbol)
         * to match the visual operators displayed on the calculator buttons
         */
        const KEY_MAP = {
            // Number keys (0-9)
            '0': { selector: 'button[data-number="0"]', type: 'number' },
            '1': { selector: 'button[data-number="1"]', type: 'number' },
            '2': { selector: 'button[data-number="2"]', type: 'number' },
            '3': { selector: 'button[data-number="3"]', type: 'number' },
            '4': { selector: 'button[data-number="4"]', type: 'number' },
            '5': { selector: 'button[data-number="5"]', type: 'number' },
            '6': { selector: 'button[data-number="6"]', type: 'number' },
            '7': { selector: 'button[data-number="7"]', type: 'number' },
            '8': { selector: 'button[data-number="8"]', type: 'number' },
            '9': { selector: 'button[data-number="9"]', type: 'number' },
            
            // Decimal point
            '.': { selector: 'button[data-number="."]', type: 'number' },
            
            // Operators
            '+': { selector: 'button[data-operator="+"]', type: 'operator' },
            '-': { selector: 'button[data-operator="-"]', type: 'operator' },
            '*': { selector: 'button[data-operator="×"]', type: 'operator' },
            '/': { selector: 'button[data-operator="÷"]', type: 'operator' },
            
            // Actions
            'Enter': { selector: 'button[data-action="equals"]', type: 'action' },
            '=': { selector: 'button[data-action="equals"]', type: 'action' },
            'Escape': { selector: 'button[data-action="clear"]', type: 'action' },
            'Backspace': { selector: 'button[data-action="delete"]', type: 'action' }
        };

        /**
         * Keyboard Event Handler
         * Handles all keyboard input and maps to calculator buttons
         * @class
         */
        class KeyboardHandler {
            /**
             * Create a keyboard handler
             * @param {Object} keyMap - Map of keyboard keys to button selectors
             * @param {Function} buttonClickCallback - Callback function to invoke when a button is activated
             */
            constructor(keyMap, buttonClickCallback) {
                this.keyMap = keyMap;
                this.buttonClickCallback = buttonClickCallback;
                this.init();
            }

            /**
             * Initialize global keyboard event listener
             * @returns {void}
             */
            init() {
                document.addEventListener('keydown', (event) => {
                    this.handleKeyPress(event);
                });
            }

            /**
             * Handle keyboard key press
             * @param {KeyboardEvent} event - The keyboard event
             * @returns {void}
             */
            handleKeyPress(event) {
                const mapping = this.keyMap[event.key];
                
                if (mapping) {
                    event.preventDefault();
                    const button = document.querySelector(mapping.selector);
                    
                    if (button) {
                        this.activateButton(button);
                    }
                }
            }

            /**
             * Activate button with visual feedback
             * @param {HTMLElement} button - The button element to activate
             * @returns {void}
             */
            activateButton(button) {
                // Trigger button action via callback
                this.buttonClickCallback(button);
            }
        }

        // ============================================================================
        // CALCULATOR DISPLAY AND BUTTON HANDLING
        // ============================================================================
        
        const previousOperandDisplay = document.getElementById('previousOperand');
        const currentOperandDisplay = document.getElementById('currentOperand');
        
        /**
         * Handle button click/activation
         * @param {HTMLElement} button - The button that was clicked or activated
         * @returns {void}
         */
        function handleButtonClick(button) {
            // Visual feedback only - logic will be added in next task
            console.log('Button activated:', button.textContent);
            
            // Add visual feedback
            provideFeedback(button);
        }

        /**
         * Provide visual feedback for button activation
         * @param {HTMLElement} button - The button to provide feedback for
         * @returns {void}
         */
        function provideFeedback(button) {
            button.classList.add('pressed');
            
            setTimeout(() => {
                button.classList.remove('pressed');
            }, 100);
        }

        // ============================================================================
        // INITIALIZATION
        // ============================================================================
        
        // Initialize button click event listeners
        document.querySelectorAll('button').forEach(button => {
            button.addEventListener('click', function() {
                handleButtonClick(this);
            });
        });

        // Initialize keyboard event handler with dependency injection
        const keyboardHandler = new KeyboardHandler(KEY_MAP, handleButtonClick);
    </script>
</body>
</html>
