<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculator</title>
    <link rel="stylesheet" href="calculator.css">
</head>
<body>
    <div class="calculator" role="application" aria-label="Calculator">
        <div class="display">
            <div class="display-previous" id="previousOperand" role="status" aria-live="polite" aria-atomic="true" aria-label="Previous calculation"></div>
            <div class="display-current" id="currentOperand" role="status" aria-live="polite" aria-atomic="true" aria-label="Current value">0</div>
        </div>
        <div class="buttons">
            <button class="btn-clear" data-action="clear" aria-label="Clear all">AC</button>
            <button class="btn-delete" data-action="delete" aria-label="Delete last digit">DEL</button>
            <button class="btn-operator" data-operator="÷" aria-label="Divide">÷</button>
            
            <button data-number="7" aria-label="Number 7">7</button>
            <button data-number="8" aria-label="Number 8">8</button>
            <button data-number="9" aria-label="Number 9">9</button>
            <button class="btn-operator" data-operator="×" aria-label="Multiply">×</button>
            
            <button data-number="4" aria-label="Number 4">4</button>
            <button data-number="5" aria-label="Number 5">5</button>
            <button data-number="6" aria-label="Number 6">6</button>
            <button class="btn-operator" data-operator="-" aria-label="Subtract">-</button>
            
            <button data-number="1" aria-label="Number 1">1</button>
            <button data-number="2" aria-label="Number 2">2</button>
            <button data-number="3" aria-label="Number 3">3</button>
            <button class="btn-operator" data-operator="+" aria-label="Add">+</button>
            
            <button class="btn-zero" data-number="0" aria-label="Number 0">0</button>
            <button data-number="." aria-label="Decimal point">.</button>
            <button class="btn-equals" data-action="equals" aria-label="Calculate result">=</button>
        </div>
    </div>

    <script>
        // ============================================================================
        // KEYBOARD EVENT LISTENER INFRASTRUCTURE
        // ============================================================================
        
        /**
         * Centralized key mapping system
         * Maps keyboard keys to calculator button selectors
         */
        const KEY_MAP = {
            // Number keys (0-9)
            '0': { selector: 'button[data-number="0"]', type: 'number' },
            '1': { selector: 'button[data-number="1"]', type: 'number' },
            '2': { selector: 'button[data-number="2"]', type: 'number' },
            '3': { selector: 'button[data-number="3"]', type: 'number' },
            '4': { selector: 'button[data-number="4"]', type: 'number' },
            '5': { selector: 'button[data-number="5"]', type: 'number' },
            '6': { selector: 'button[data-number="6"]', type: 'number' },
            '7': { selector: 'button[data-number="7"]', type: 'number' },
            '8': { selector: 'button[data-number="8"]', type: 'number' },
            '9': { selector: 'button[data-number="9"]', type: 'number' },
            
            // Decimal point
            '.': { selector: 'button[data-number="."]', type: 'number' },
            
            // Operators
            '+': { selector: 'button[data-operator="+"]', type: 'operator' },
            '-': { selector: 'button[data-operator="-"]', type: 'operator' },
            '*': { selector: 'button[data-operator="×"]', type: 'operator' },
            '/': { selector: 'button[data-operator="÷"]', type: 'operator' },
            
            // Actions
            'Enter': { selector: 'button[data-action="equals"]', type: 'action' },
            '=': { selector: 'button[data-action="equals"]', type: 'action' },
            'Escape': { selector: 'button[data-action="clear"]', type: 'action' },
            'Backspace': { selector: 'button[data-action="delete"]', type: 'action' }
        };

        /**
         * Keyboard Event Handler
         * Handles all keyboard input and maps to calculator buttons
         */
        class KeyboardHandler {
            constructor(keyMap) {
                this.keyMap = keyMap;
                this.activeButton = null;
                this.init();
            }

            /**
             * Initialize global keyboard event listener
             */
            init() {
                document.addEventListener('keydown', (event) => {
                    this.handleKeyPress(event);
                });
            }

            /**
             * Handle keyboard key press
             * @param {KeyboardEvent} event - The keyboard event
             */
            handleKeyPress(event) {
                const mapping = this.keyMap[event.key];
                
                if (mapping) {
                    event.preventDefault();
                    const button = document.querySelector(mapping.selector);
                    
                    if (button) {
                        this.activateButton(button);
                    }
                }
            }

            /**
             * Activate button with focus and visual feedback
             * @param {HTMLElement} button - The button element to activate
             */
            activateButton(button) {
                // Focus management
                this.setActiveButton(button);
                
                // Trigger button action
                handleButtonClick(button);
            }

            /**
             * Set active button with focus
             * @param {HTMLElement} button - The button to set as active
             */
            setActiveButton(button) {
                if (this.activeButton) {
                    this.activeButton.blur();
                }
                this.activeButton = button;
                button.focus();
            }

            /**
             * Clear active button
             */
            clearActiveButton() {
                if (this.activeButton) {
                    this.activeButton.blur();
                    this.activeButton = null;
                }
            }
        }

        // ============================================================================
        // CALCULATOR DISPLAY AND BUTTON HANDLING
        // ============================================================================
        
        const previousOperandDisplay = document.getElementById('previousOperand');
        const currentOperandDisplay = document.getElementById('currentOperand');
        
        /**
         * Handle button click/activation
         * @param {HTMLElement} button - The button that was clicked or activated
         */
        function handleButtonClick(button) {
            // Visual feedback only - logic will be added in next task
            console.log('Button activated:', button.textContent);
            
            // Add visual feedback
            provideFeedback(button);
        }

        /**
         * Provide visual feedback for button activation
         * @param {HTMLElement} button - The button to provide feedback for
         */
        function provideFeedback(button) {
            button.style.transform = 'translateY(0)';
            button.style.boxShadow = '0 2px 6px rgba(0, 0, 0, 0.1)';
            
            setTimeout(() => {
                button.style.transform = '';
                button.style.boxShadow = '';
            }, 100);
        }

        // ============================================================================
        // INITIALIZATION
        // ============================================================================
        
        // Initialize button click event listeners
        document.querySelectorAll('button').forEach(button => {
            button.addEventListener('click', function() {
                handleButtonClick(this);
            });
        });

        // Initialize keyboard event handler
        const keyboardHandler = new KeyboardHandler(KEY_MAP);
    </script>
</body>
</html>
